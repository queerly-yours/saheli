<div class="results-page saheli-style">

    <!-- SPINNER -->
    <div class="loading-container" *ngIf="loading">
        <div class="spinner"></div>
    </div>

    <!-- CONTENT -->
    <ng-container *ngIf="!loading">

        @if (query) {
        <div class="search-query-header">Search results for "{{ query }}"</div>
        } @else {
        <div class="search-query-header">Search results:</div>
        }

        <div *ngIf="pagedResults.length === 0" class="no-results">Sorry, we couldn’t find that. Let’s try searching
            differently.</div>

        <div class="paged-results-wrapper" [class.page-changing]="pageChanging">
            <div *ngFor="let r of pagedResults" class="row">
                <div class="searched-row" (click)="onClick(r)">
                    <div class="title" [innerHTML]="getHighlighted(r, 'title')"></div>
                    <div class="subtitle" *ngIf="r.item.subtitle" [innerHTML]="getHighlighted(r, 'subtitle')"></div>
                    <div class="meta">{{ r.item.payload.publishedDate }}</div>
                    <div class="snippet" *ngIf="getSnippet(r) as snip" [innerHTML]="snip"></div>
                </div>
                <div class="tags-wrapper">
                    @if (r.item.categoryIdList) {
                    <div *ngFor="let categoryId of r.item.categoryIdList" class="tag"
                        (click)="navigate(categoryId, paramTypes.Category)">
                        {{getCategoryValue(categoryId)}}
                    </div>
                    }
                    @if (r.item.categoryIdList) {
                    <div *ngFor="let subcategoryId of r.item.subCategoryIdList" class="tag"
                        (click)="navigate(subcategoryId, paramTypes.SubCategory)">
                        {{getSubCategoryValue(subcategoryId)}}
                    </div>
                    }
                </div>
            </div>
        </div>


        <div class="pager" *ngIf="totalPages > 1">
            <button class="arrow" aria-label="Previous page" (click)="setPage(page - 1)" [disabled]="page === 1">
                <ng-icon name="heroArrowLeftCircle" size="20"></ng-icon>
            </button>

            <ng-container *ngFor="let p of visiblePages">
                <button *ngIf="p !== 'ellipsis'" class="number" [class.active]="page === p" (click)="setPage(p)">
                    {{ p }}
                </button>

                <span *ngIf="p === 'ellipsis'" class="ellipsis">…</span>
            </ng-container>

            <button class="arrow" aria-label="Next page" (click)="setPage(page + 1)" [disabled]="page === totalPages">
                <ng-icon name="heroArrowRightCircle" size="20"></ng-icon>
            </button>
        </div>
    </ng-container>
</div>